(function(){var t="http://www.w3.org/2000/svg",e="http://www.w3.org/2000/xmlns/",i="http://www.w3.org/1999/xlink",s=function(e){r("INIT","Initialize etreecell canvas."),this.dom={canvas:document.getElementById(e),html:document.createElement("div")},this.svg={canvas:document.createElementNS(t,"svg"),linkingLine:document.createElementNS(t,"path")},this.saveValues={etreecell:["defaultAttr"],cell:["id","type","attr","data"],link:["id","attr","io","id","data"]},this.cell={},this.link={},this.typeList={cell:{},link:{}},this.defaultAttr={cell:{cell:{x:20,y:10,width:120,height:30,stroke:"white",fill:"none","stroke-width":2,rx:10,ry:10,"pointer-events":"visible",cursor:"pointer"},selected:{x:0,y:0,"etcl-margin-left":-12,"etcl-margin-right":-12,"etcl-margin-top":-12,"etcl-margin-bottom":-12,width:100,height:20,"etcl-float":"left,top,right,bottom","stroke-dasharray":"3, 3","stroke-width":2,stroke:"white",rx:7,ry:7,fill:"none"},resize:{"etcl-margin-right":-7,"etcl-margin-bottom":-7,"etcl-float":"right,bottom",width:10,height:10,cursor:"nw-resize",fill:"rgba(255,255,255,.2)","etcl-d":"M 10 10 L 0 10 L 10 0 Z"},linker:{common:{fill:"rgba(255,255,255,.2)",cx:6,cy:6,r:4,"etcl-margin-right":-5,"etcl-margin-top":-5,"etcl-margin-bottom":-5,"etcl-margin-left":-5},top:{"etcl-float":"x-center,top"},right:{"etcl-float":"y-center,right"},bottom:{"etcl-float":"x-center,bottom"},left:{"etcl-float":"y-center,left"}}},link:{line:{stroke:"white","stroke-width":2,fill:"none"},linkingLine:{d:"M 0 0 0 0","stroke-dasharray":"3,3",stroke:"rgba(255,255,255,.3)","stroke-width":2,"start-margin-left":-1,"start-margin-top":-1,"end-margin-left":-10,"end-margin-top":-10}},helper:{css:{linkingLine:".linkingLine { display:none;} .linkingLine.show { display:inline;}",selector:".selector { opacity: 0; z-index:-1; transition: opacity .2s cubic-bezier(0.860, 0.000, 0.070, 1.000); } .selector.editing { stroke:orange; opacity:1; } .selector.selected {opacity:.3; transition: opacity .2s cubic-bezier(0.860, 0.000, 0.070, 1.000); .selector.disable {display:none;} }",resize:".resize { opacity: 0; z-index:-1; transition: opacity .2s cubic-bezier(0.860, 0.000, 0.070, 1.000); } .resize.selected {opacity:1; transition: opacity .2s cubic-bezier(0.860, 0.000, 0.070, 1.000); } .resize.disable {display:none;}",linker:".linker { opacity: 0; z-index:-1; transition: opacity .2s cubic-bezier(0.860, 0.000, 0.070, 1.000); } .linker.show {opacity:1; transition: opacity .2s cubic-bezier(0.860, 0.000, 0.070, 1.000);} .linker.linkingStart { fill:#009cff;opacity:1 !important; } .linker.linkingEnd { fill:#f13870;opacity:1 !important; }"}}},this.historyStack={undo:[],redo:[]},this.selected={cell:[],link:[]},this.editing={cell:null,link:null},r("INIT","Etreecell"),this.draw(),this.creatable(!0),this.svg.canvas.etcl=this;var i="";for(var s in this.defaultAttr.helper.css)i+=this.defaultAttr.helper.css[s]+" ";return this.createCSS(i),this};s.prototype={createCell:function(t,e,i,s){r("ETCL","Create Cell.");var n=a(),c=this.cell[t||n]=new l(this,t||n,e||{},i||"textbox",s||{});return c},createLink:function(t,e,i,s){if(r("ETCL","Create Link."),t==e)return r("ETCL","OutputCell and InputCell is equal cell."),!1;if(this.link[t.id+"_"+e.id])return r("ETCL","This is existed link."),!1;var l=this.link[t.id+"_"+e.id]=new n(this,t,e,t.id+"_"+e.id,i||{},s||{});return l},getCellById:function(t){return r("ETCL","Get cell id : "+t),this.cell[t]||!1},getLinkById:function(t){return r("ETCL","Get link id : "+t),this.link[t]||!1},createCSS:function(t){var e=document.createElement("style");e.type="text/css",e.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(e)},creatable:function(t){},draw:function(){this._draggingMove=!1,this._draggingSelect=!1,this._draggingResize=!1,this._draggingTarget=!1,this.svg.canvas.setAttribute("width","100%"),this.svg.canvas.setAttribute("height","100%"),this.svg.canvas.setAttribute("style","position:absolute;"),this.svg.canvas.setAttribute("left","0"),this.svg.canvas.setAttribute("top","0"),this.svg.canvas.setAttributeNS(e,"xmlns:xlink",i),this.dom.canvas.appendChild(this.svg.canvas),this.dom.html.setAttribute("width","100%"),this.dom.html.setAttribute("height","100%"),this.dom.html.setAttribute("style","position:absolute;"),this.dom.html.setAttribute("left","0"),this.dom.html.setAttribute("top","0"),this.dom.canvas.appendChild(this.dom.html);for(var t in this.defaultAttr.link.linkingLine)this.svg.linkingLine.setAttributeNS(null,t,this.defaultAttr.link.linkingLine[t]);h(this.svg.linkingLine,"linkingLine"),this.svg.canvas.appendChild(this.svg.linkingLine),this.svg.canvas.addEventListener("dblclick",function(t){this.etcl._draggingMove||this._draggingSelect||this.etcl.createCell(null,{x:t.clientX-this.etcl.defaultAttr.cell.cell.width/2-this.etcl.defaultAttr.cell.cell["stroke-width"],y:t.clientY-this.etcl.defaultAttr.cell.cell.height/2-this.etcl.defaultAttr.cell.cell["stroke-width"]})}),this.svg.canvas.addEventListener("mousedown",function(t){r("ETCL","mousedown"),0==this.etcl.selected.cell.length,this.etcl._originPos={x:t.clientX,y:t.clientY};for(var e in this.etcl.selected.cell){var i=this.etcl.selected.cell[e];i._originPos={x:i.getAttr("x"),y:i.getAttr("y"),width:i.getAttr("width"),height:i.getAttr("height")}}if(this.etcl._draggingResize){var i=this.etcl._draggingResize.cell;i._originPos={x:i.getAttr("x"),y:i.getAttr("y"),width:i.getAttr("width"),height:i.getAttr("height")}}if(this.etcl._draggingLink){var s=this.etcl.svg.linkingLine;[s.getAttribute("start-margin-left"),s.getAttribute("start-margin-top"),s.getAttribute("end-margin-left"),s.getAttribute("end-margin-top")];s.setAttributeNS(null,"d","M 0 0 0 0"),h(s,"show")}}),this.svg.canvas.addEventListener("mousemove",function(t){if(this.etcl._draggingMove)for(var e in this.etcl.selected.cell){var i=this.etcl.selected.cell[e];i.setAttr({x:i._originPos.x+t.clientX-this.etcl._originPos.x,y:i._originPos.y+t.clientY-this.etcl._originPos.y})}if(this.etcl._draggingResize&&(i=this.etcl._draggingResize.cell,i.setAttr({width:i._originPos.width+t.clientX-this.etcl._originPos.x<1?1:i._originPos.width+t.clientX-this.etcl._originPos.x,height:i._originPos.height+t.clientY-this.etcl._originPos.y<1?1:i._originPos.height+t.clientY-this.etcl._originPos.y})),this.etcl._draggingLink){var s=this.etcl.svg.linkingLine,l=this.etcl._draggingLink;h(this.etcl._draggingLink,"linkingStart");var n=[s.getAttribute("start-margin-left"),s.getAttribute("start-margin-top"),s.getAttribute("end-margin-left"),s.getAttribute("end-margin-top")];s.setAttributeNS(null,"d","M "+(parseInt(l.getAttribute("cx"))+parseInt(n[0]))+" "+(parseInt(l.getAttribute("cy"))+parseInt(n[1]))+" L "+(t.clientX+parseInt(n[2]))+" "+(t.clientY+parseInt(n[3])))}}),this.svg.canvas.addEventListener("click",function(t){this.etcl._draggingResize||this.etcl.selectCell(),this.etcl._draggingResize=!1}),this.svg.canvas.addEventListener("mouseup",function(t){this.etcl._draggingLink&&this.etcl._draggingTarget&&this.etcl._draggingLink.cell.linkTo(this.etcl._draggingTarget.cell),this.etcl._draggingMove=!1,this.etcl._draggingLink=!1,this.etcl._draggingTarget=!1;for(var e=this.etcl.dom.canvas.getElementsByClassName("linkingStart"),i=this.etcl.dom.canvas.getElementsByClassName("linkingEnd");0!=e.length;)o(e[0],"linkingStart");for(;0!=i.length;)o(i[0],"linkingEnd");o(this.etcl.svg.linkingLine,"show")})},exportToJson:function(){var t={etreecell:{},cell:{},link:{}};for(var e in this.saveValues.etreecell){var i=this.saveValues.etreecell[e];t.etreecell[i]=this[i]}for(var e in this.cell){var s=this.cell[e];t.cell[s.id]={};for(var l in this.saveValues.cell){var i=this.saveValues.cell[l];t.cell[s.id][i]=s[i]}}for(var e in this.link){var n=this.link[e];t.link[n.id]={};for(var l in this.saveValues.link){var i=this.saveValues.link[l];"io"==i?t.link[n.id].io={output:n[i].output.id,input:n[i].input.id}:t.link[n.id][i]=n[i]}}return r("EXPORT TO JSON",t),t},importFromJson:function(t){r("IMPORT FROM JSON",t);var e=JSON.parse(t);this.setDefaultAttr(e.etreecell.defaultAttr);for(var i in e.cell){var s=e.cell[i];this.createCell(s.id,s.attr,s.type,s.data)}for(var i in e.link){var l=e.link[i];this.createLink(this.getCellById(l.io.output),this.getCellById(l.io.input),l.attr,l.data)}return this},setDefaultAttr:function(t){return r("SET DEFAULT ATTR",t),this.defaultAttr=t,this},selectCell:function(t){for(var e in this.selected.cell)this.selected.cell[e].removeClass("selected");if(this.editing.cell&&this.editing.cell!=t&&this.editing.cell.editEnd(),this.selected.cell.splice(0,this.selected.cell.length),!t)return this;if(t instanceof Array)for(var e in t)this.selected.cell.push(t[e]),t[e].addClass("selected");else this.selected.cell.push(t),t.addClass("selected");return this},editStartCell:function(t){t.addClass("editing"),this.selectCell(t),this.editing.cell=t;try{t.type.editStart(),t.setAttr({x:t.getAttr("x"),y:t.getAttr("y"),width:t.getAttr("width"),height:t.getAttr("height")})}catch(t){r("ETCL_TYPE","Edit Start is not exist function."+t)}},editEndCell:function(t){t.removeClass("editing"),this.editing.cell=null;try{t.type.editEnd()}catch(t){r("ETCL_TYPE","Edit End is not exist function.")}},updateDataCell:function(t,e){try{t.type.updateData()}catch(t){r("ETCL_TYPE","Update data is not exist function.")}},addCellTypeList:function(t){r("ETCL_TYPE","Add cell type");for(var e in t.cell)this.typeList.cell[e]=t.cell[e];for(var e in t.link)this.typeList.link[e]=t.link[e];return this},createCellType:function(t,e,i){r("ETCL_TYPE","Create cell type");var s=new this.typeList.cell[i](t,e,i);return s.id=i,s.etcl=t,s.cell=e,s}};var l=function(t,e,i,s,l){r("CELL","Initialize Cell : "+e),this.etcl=t,this.id=e,this.attr={},this.io={input:[],output:[]},this.data=l,this.svg={cell:null,selected:null,resize:null,linker:{top:null,right:null,bottom:null,left:null}},this.fitList={move:[],resize:[]},this.eventList={dragStart:[],dragMove:[],dragEnd:[],editStart:[],editEnd:[],updateData:[]};for(var n in t.defaultAttr.cell.cell)this.attr[n]=t.defaultAttr.cell.cell[n];for(var n in i)this.attr[n]=i[n];return this.draw(),this.draggable(this.attr.draggable||!0),this.type=t.createCellType(t,this,s),this};l.prototype={draw:function(){r("CELL","Draw cell"),this.svg.cell=document.createElementNS(t,"rect"),this.svg.cell.setAttributeNS(null,"id",this.id),this.svg.cell.cell=this,this.svg.cell.etcl=this.etcl,this.svg.cell.addEventListener("mousedown",function(t){this.cell.etcl._draggingMove=!0,this.cell.select()}),this.svg.cell.addEventListener("mousemove",function(t){}),this.svg.cell.addEventListener("mouseenter",function(t){for(var e in this.cell.svg.linker)h(this.cell.svg.linker[e],"show");if(this.etcl._draggingLink&&this.etcl._draggingLink.cell.id!=this.id){for(var e in this.cell.svg.linker)h(this.cell.svg.linker[e],"linkingEnd");this.etcl._draggingTarget=this}}),this.svg.cell.addEventListener("mouseleave",function(t){for(var e in this.cell.svg.linker)o(this.cell.svg.linker[e],"show"),o(this.cell.svg.linker[e],"linkingEnd");this.etcl._draggingTarget=!1}),this.svg.cell.addEventListener("mouseup",function(t){this.etcl._draggingMove=!1}),this.svg.cell.addEventListener("click",function(t){r("CELL","Click"),t.stopPropagation()}),this.svg.cell.addEventListener("dblclick",function(t){r("CELL","DBLClick"),t.stopPropagation(),this.cell.editStart()}),this.svg.selected=document.createElementNS(t,"rect"),this.svg.selected.setAttributeNS(null,"id","selected_"+this.id),this.svg.selected.setAttributeNS(null,"etcl-cell-id",this.id),this.svg.selected.setAttributeNS(null,"class","selector");for(var e in this.etcl.defaultAttr.cell.selected)this.svg.selected.setAttributeNS(null,e,this.etcl.defaultAttr.cell.selected[e]);this.svg.selected.cell=this,this.svg.selected.etcl=this.etcl,this.svg.resize=document.createElementNS(t,"path"),this.svg.resize.setAttributeNS(null,"id","resize_"+this.id),this.svg.resize.setAttributeNS(null,"etcl-cell-id",this.id),this.svg.resize.setAttributeNS(null,"class","resize"),this.svg.resize.cell=this,this.svg.resize.etcl=this.etcl,this.svg.linker={top:document.createElementNS(t,"circle"),right:document.createElementNS(t,"circle"),bottom:document.createElementNS(t,"circle"),left:document.createElementNS(t,"circle")};for(var e in this.svg.linker){var i=this.svg.linker[e];i.setAttributeNS(null,"id","linker_"+e+"_"+this.id),i.setAttributeNS(null,"etcl-cell-id",this.id),i.setAttributeNS(null,"class","linker"),i.cell=this,i.etcl=this.etcl;for(var s in this.etcl.defaultAttr.cell.linker.common)i.setAttributeNS(null,s,this.etcl.defaultAttr.cell.linker.common[s]);for(var s in this.etcl.defaultAttr.cell.linker[e])i.setAttributeNS(null,s,this.etcl.defaultAttr.cell.linker[e][s]);i.addEventListener("mouseenter",function(t){for(var e in this.cell.svg.linker)h(this.cell.svg.linker[e],"show")}),i.addEventListener("mouseleave",function(t){for(var e in this.cell.svg.linker)o(this.cell.svg.linker[e],"show"),o(this.cell.svg.linker[e],"linkingEnd")}),i.addEventListener("mousedown",function(t){this.etcl._draggingLink=this}),i.addEventListener("mousemove",function(t){this.etcl._draggingLink&&this.etcl._draggingLink!=this&&(h(this,"linkingEnd"),this.etcl._draggingTarget=this)})}for(var e in this.etcl.defaultAttr.cell.resize)this.svg.resize.setAttributeNS(null,e,this.etcl.defaultAttr.cell.resize[e]);this.svg.resize.addEventListener("mousedown",function(t){this.cell.etcl._draggingResize=this}),this.svg.resize.addEventListener("mousemove",function(t){}),this.svg.resize.addEventListener("mouseup",function(t){}),this.etcl.svg.canvas.appendChild(this.svg.selected),this.etcl.svg.canvas.appendChild(this.svg.resize);for(var e in this.svg.linker)this.etcl.svg.canvas.appendChild(this.svg.linker[e]);return this.etcl.svg.canvas.appendChild(this.svg.cell),this.setAttr(this.attr),this.svg.cell},linkable:function(){},resizable:function(t){return t?o(this.svg.resize,"disable"):h(this.svg.resize,"disable"),this},editable:function(t){return t&&this.svg.cell.addEventListener("dblclick",function(t){t.stopPropagation()}),this},draggable:function(t){return r("CELL","Dragable"),this},focus:function(t){},select:function(){this.etcl.selectCell(this)},editStart:function(){return this.etcl.editStartCell(this),this},editEnd:function(){return this.etcl.editEndCell(this),this},updateData:function(t){return this.etcl.updateData(this,t),this},getAttr:function(t){return this.attr[t]||!1},getLinksByOutput:function(){var t=[];for(var e in this.io.output)t.push(this.etcl.getLinkById(this.io.output[e].id+"_"+this.id));return t},getLinksByInput:function(){var t=[];for(var e in this.io.input)t.push(this.etcl.getLinkById(this.id+"_"+this.io.input[e].id));return t},addFit:function(){},floatFit:function(t,e,i){var s=(t.getAttribute("etcl-float")||"left,top").replace("/ /gi","").split(","),l={x:0,y:0,width:0,height:0};switch(s.indexOf("left")!==-1&&(l.x=("x"==i?e:this.getAttr("x"))+parseInt(t.getAttribute("etcl-margin-left")||0)),s.indexOf("right")!==-1&&(l.x=("x"==i?e:this.getAttr("x"))+parseInt(this.getAttr("width"))-parseInt(t.getAttribute("width")||0)-parseInt(t.getAttribute("etcl-margin-right")||0)),s.indexOf("top")!==-1&&(l.y=("y"==i?e:this.getAttr("y"))+parseInt(t.getAttribute("etcl-margin-top")||0)),s.indexOf("x-center")!==-1&&(l.x=("x"==i?e:this.getAttr("x"))+parseInt(this.getAttr("width")/2)),s.indexOf("y-center")!==-1&&(l.y=("y"==i?e:this.getAttr("y"))+parseInt(this.getAttr("height")/2)),s.indexOf("bottom")!==-1&&(l.y=("y"==i?e:this.getAttr("y"))+parseInt(this.getAttr("height"))-parseInt(t.getAttribute("height")||0)-parseInt(t.getAttribute("etcl-margin-bottom")||0)),s.indexOf("left")!==-1&&s.indexOf("right")!==-1&&(l.x=("x"==i?e:this.getAttr("x"))+parseInt(t.getAttribute("etcl-margin-left")||0),l.width=("width"==i?e:0)+parseInt(t.getAttribute("etcl-margin-right")*-1||0)+parseInt(t.getAttribute("etcl-margin-left")*-1||0)),s.indexOf("top")!==-1&&s.indexOf("bottom")!==-1&&(l.y=("y"==i?e:this.getAttr("y"))+parseInt(t.getAttribute("etcl-margin-top")||0),l.height=("height"==i?e:0)+parseInt(t.getAttribute("etcl-margin-top")*-1||0)+parseInt(t.getAttribute("etcl-margin-bottom")*-1||0)),t.tagName.toLowerCase()){case"rect":t.setAttributeNS(null,i,l[i]);break;case"div":break;case"textarea":t.style.position="absolute","x"==i?t.style.left=l.x:"y"==i?t.style.top=l.y:"width"==i?t.style.width=l.width:"height"==i&&(t.style.height=l.height);break;case"path":g(t,l.x,l.y);break;case"circle":t.setAttributeNS(null,"cx",l.x),t.setAttributeNS(null,"cy",l.y)}return this},setAttr:function(t){r("CELL","Set the cell style.");var e=["id","d","x","y","cx","xy","r","width","height","stroke","fill","stroke-width","rx","ry","pointer-events"],i=["cursor"];if("object"==typeof t)for(var s in t)if(e.indexOf(s)!==-1){this.svg.cell.setAttributeNS(null,s,t[s]),this.attr[s]=t[s],"x"!=s&&"y"!=s&&"width"!=s&&"height"!=s||(this.floatFit(this.svg.resize,t[s],s),this.floatFit(this.svg.selected,t[s],s),this.floatFit(this.svg.linker.top,t[s],s),this.floatFit(this.svg.linker.right,t[s],s),this.floatFit(this.svg.linker.bottom,t[s],s),this.floatFit(this.svg.linker.left,t[s],s));for(var l in this.fitList.move)"x"!=s&&"y"!=s&&"width"!=s&&"height"!=s||this.floatFit(this.fitList.move[l],t[s],s)}else i.indexOf(s)!==-1&&(this.svg.cell.style[s]=t[s],this.attr[s]=t[s]);var n=this.getLinksByOutput();for(var l in n)n[l].updateLine();var a=this.getLinksByInput();for(var l in a)a[l].updateLine();return this},addEvent:function(t,e){return this.eventList[t].push(e),this},linkTo:function(t,e){return r("LINK","Link to "+t.id),this.etcl.createLink(this,t,e||[]),this},addClass:function(t){return h(this.svg.cell,t),h(this.svg.selected,t),h(this.svg.resize,t),this},removeClass:function(t){return o(this.svg.cell,t),o(this.svg.selected,t),o(this.svg.resize,t),this},hasClass:function(t){return c(this.svg.cell,t)}};var n=function(t,e,i,s,l,n){r("LINK","Initialize Link."+s),this.etcl=t,this.id=s,this.attr={},this.data=n,this.svg={line:null,text:null},this.io={output:e,input:i};for(var a in t.defaultAttr.link.line)this.attr[a]=t.defaultAttr.link.line[a];for(var a in l)this.attr[a]=l[a];e.io.input.push(i),i.io.output.push(e),this.draw()};n.prototype={draw:function(){return r("LINK","Draw link"),this.svg.line=document.createElementNS(t,"path"),this.svg.line.setAttributeNS(null,"id",this.id),this.setAttr(this.attr),this.etcl.svg.canvas.appendChild(this.svg.line),this.svg.line.link=this,this.svg.line.etcl=this.etcl,this.updateLine(),this.svg.line},updateLine:function(){this.drawLine(this.io.output.getAttr("x"),this.io.output.getAttr("y"),this.io.output.getAttr("width"),this.io.output.getAttr("height"),this.io.output.getAttr("stroke-width"),this.io.input.getAttr("x"),this.io.input.getAttr("y"),this.io.input.getAttr("width"),this.io.input.getAttr("height"),this.io.input.getAttr("stroke-width"))},drawLine:function(t,e,i,s,l,n,a,c,h,o){r("LINK","draw line of link");for(var g=[{x:t+i/2,y:e-l/2},{x:t+i/2,y:e+s+l/2},{x:t-l/2,y:e+s/2},{x:t+i+l/2,y:e+s/2},{x:n+c/2,y:a-o/2},{x:n+c/2,y:a+h+o/2},{x:n-o/2,y:a+h/2},{x:n+c+o/2,y:a+h/2}],d={},u=[],v=0;v<4;v++)for(var f=4;f<8;f++){var p=Math.abs(g[v].x-g[f].x),k=Math.abs(g[v].y-g[f].y);(v==f-4||(3!=v&&6!=f||g[v].x<g[f].x)&&(2!=v&&7!=f||g[v].x>g[f].x)&&(0!=v&&5!=f||g[v].y>g[f].y)&&(1!=v&&4!=f||g[v].y<g[f].y))&&(u.push(p+k),d[u[u.length-1]]=[v,f])}var m;m=0==u.length?[0,4]:d[Math.min.apply(Math,u)];var t=g[m[0]].x,e=g[m[0]].y,y=g[m[1]].x,A=g[m[1]].y;p=Math.max(Math.abs(t-y)/2,10),k=Math.max(Math.abs(e-A)/2,10);var n=[t,t,t-p,t+p][m[0]].toFixed(3),a=[e-k,e+k,e,e][m[0]].toFixed(3),b=[0,0,0,0,y,y,y-p,y+p][m[1]].toFixed(3),L=[0,0,0,0,e+k,e-k,A,A][m[1]].toFixed(3);return this.svg.line.setAttributeNS(null,"d",["M",t.toFixed(3),e.toFixed(3),"C",n,a,b,L,y.toFixed(3),A.toFixed(3)].join(" ").toString()),this},addEvent:function(t,e){this.eventList[t].push(e)},setAttr:function(t){r("LINK","Set the link style.");var e=["id","d","x","y","width","height","stroke","fill","stroke-width","rx","ry","pointer-events"],i=["cursor"];if("object"==typeof t)for(var s in t)e.indexOf(s)!==-1?(this.svg.line.setAttributeNS(null,s,t[s]),this.attr[s]=t[s]):i.indexOf(s)!==-1&&(this.svg.line.style[s]=t[s],this.attr[s]=t[s]);return this},setData:function(t){for(var e in t)this.data[e]=t[e];return this},getData:function(t){return this.data(t)},getAttr:function(){return this.attr[attr]||!1}};var r=function(t,e){var i=!0;i&&"ETCL_TYPE"==t&&("object"==typeof e&&(e=JSON.stringify(e)),console.log("[ETREECELL] ["+t+"] "+e))},a=function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},c=function(t,e){return t.classList?t.classList.contains(e):!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))},h=function(t,e){t.classList?t.classList.add(e):c(t,e)||(t.className+=" "+e)},o=function(t,e){if(t.classList)t.classList.remove(e);else if(c(t,e)){var i=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(i," ")}},g=function(t,e,i){var s=t.getAttribute("etcl-d").split(" "),l=!0;for(var n in s)isNaN(parseInt(s[n]))||(l?s[n]=parseInt(s[n])+e:s[n]=parseInt(s[n])+i,l=!l);return t.setAttributeNS(null,"d",s.join(" ")),s.join(" ")};window.etcl=window.etreecell=s})(window);